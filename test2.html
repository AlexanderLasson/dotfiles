<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CACI • Pluto — Prompt</title>
  <meta name="description" content="Pluto prompt UI for CACI — single-file HTMX + Tailwind chat interface with citations and guardrails." />
  
  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            ink: {
              50:'#fafafa',100:'#f4f4f5',200:'#e4e4e7',300:'#d4d4d8',400:'#a1a1aa',
              500:'#71717a',600:'#52525b',700:'#3f3f46',800:'#18181b',900:'#0a0a0b'
            },
            brand: {
              50:'#ffecec',100:'#ffd9d9',200:'#ffb3b3',300:'#ff8c8c',400:'#f26363',
              500:'#d71920',600:'#c1161c',700:'#9d1217',800:'#7a0e12',900:'#560a0d'
            }
          },
          boxShadow: {
            xl2: '0 20px 35px -15px rgba(0,0,0,0.35)'
          }
        }
      }
    }
  </script>

  <!-- HTMX -->
  <script src="https://unpkg.com/htmx.org@1.9.12"></script>
  <script src="https://unpkg.com/hyperscript.org@0.9.12"></script>

  <style>
    html { scroll-behavior: smooth; }
    .glass { backdrop-filter: blur(8px); }
  </style>
</head>
<body class="bg-ink-50 text-ink-900 selection:bg-brand-200/60">
  <!-- App Shell -->
  <div class="min-h-dvh grid grid-cols-1 md:grid-cols-[280px_1fr] lg:grid-cols-[320px_1fr_360px]">
    <!-- Sidebar: conversations -->
    <aside class="hidden md:flex flex-col border-r border-ink-200 bg-white/80">
      <div class="h-16 px-4 flex items-center justify-between border-b border-ink-100">
        <div class="flex items-center gap-3">
          <!-- Pluto logo -->
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" class="w-7 h-7">
            <defs>
              <radialGradient id="plutoCore" cx="40%" cy="35%" r="70%">
                <stop offset="0%" stop-color="#fff5f5"/>
                <stop offset="55%" stop-color="#f7c9c9"/>
                <stop offset="100%" stop-color="#d71920"/>
              </radialGradient>
              <linearGradient id="plutoShadow" x1="0" x2="1">
                <stop offset="0%" stop-color="#000" stop-opacity="0.18"/>
                <stop offset="100%" stop-color="#000" stop-opacity="0"/>
              </linearGradient>
              <clipPath id="planetClip"><circle cx="32" cy="32" r="24"/></clipPath>
            </defs>
            <ellipse cx="32" cy="38" rx="26" ry="12" fill="none" stroke="#0a0a0b" stroke-opacity="0.18" stroke-width="2"/>
            <g clip-path="url(#planetClip)">
              <circle cx="32" cy="32" r="24" fill="url(#plutoCore)" stroke="#111" stroke-width="0.5"/>
              <path d="M27 29c2-3 7-3 9 0 2 3-1 7-4 9-3-2-6-6-5-9z" fill="#fff" fill-opacity="0.6"/>
              <rect x="-10" y="18" width="84" height="10" fill="#7a0e12" opacity="0.08"/>
              <rect x="-10" y="36" width="84" height="8" fill="#560a0d" opacity="0.06"/>
              <circle cx="22" cy="22" r="3" fill="#000" opacity="0.06"/>
              <circle cx="40" cy="44" r="2" fill="#000" opacity="0.08"/>
              <rect x="0" y="0" width="64" height="64" fill="url(#plutoShadow)"/>
            </g>
          </svg>
          <div class="font-semibold">CACI • Pluto</div>
        </div>
        <a href="#" class="text-xs px-2 py-1 rounded-lg bg-brand-50 text-brand-700 border border-brand-100">New</a>
      </div>
      <div class="p-3">
        <div class="relative mb-3">
          <input class="w-full rounded-xl border border-ink-200 py-2 pl-9 pr-3 text-sm" placeholder="Search chats" />
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 absolute left-3 top-2.5 text-ink-400" viewBox="0 0 24 24" fill="currentColor"><path d="M10 2a8 8 0 105.293 14.293l4.707 4.707 1.414-1.414-4.707-4.707A8 8 0 0010 2z"/></svg>
        </div>
        <div class="space-y-2 text-sm">
          <button class="w-full text-left px-3 py-2 rounded-xl hover:bg-ink-100">IRAD Brief — faelkfjsaldf</button>
          <button class="w-full text-left px-3 py-2 rounded-xl hover:bg-ink-100">SDIT Handover Questions</button>
          <button class="w-full text-left px-3 py-2 rounded-xl hover:bg-ink-100">Telemetry Null Packets</button>
        </div>
      </div>
      <div class="mt-auto p-3 border-t border-ink-100 text-xs text-ink-500">
        <div class="flex items-center justify-between">
          <span>RBAC: <span class="font-medium text-ink-700">Engineer</span></span>
          <span class="inline-flex items-center gap-1 px-2 py-1 rounded-lg bg-ink-100">Citations <input type="checkbox" checked class="ml-1"></span>
        </div>
      </div>
    </aside>

    <!-- Main Chat -->
    <main class="flex flex-col">
      <!-- Topbar -->
      <div class="h-16 glass bg-white/70 border-b border-ink-100 px-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="md:hidden">
            <button class="p-2 rounded-lg border border-ink-200">☰</button>
          </div>
          <div class="text-sm text-ink-600">Project:</div>
          <select class="text-sm rounded-lg border border-ink-200 px-2 py-1">
            <option>PLUTO — CMS AI</option>
            <option>SDIT — Simulation</option>
          </select>
          <span class="hidden sm:inline-block text-xs px-2 py-1 rounded-lg bg-brand-50 text-brand-700 border border-brand-100">On‑prem</span>
        </div>
        <div class="flex items-center gap-2">
          <button id="openSettings" class="text-sm px-3 py-1.5 rounded-lg border border-ink-200 hover:border-brand-400">Prompt Profile</button>
          <a href="#" class="text-sm px-3 py-1.5 rounded-lg bg-brand-600 text-white hover:bg-brand-700">New Chat</a>
        </div>
      </div>

      <!-- Messages -->
      <div id="messages" class="flex-1 overflow-y-auto p-4 sm:p-6 lg:p-8 space-y-4">
        <!-- Welcome card -->
        <div class="max-w-3xl mx-auto">
          <div class="rounded-2xl border border-ink-200 bg-white p-6 shadow">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 rounded-full bg-brand-600 text-white grid place-content-center font-bold">AI</div>
              <div>
                <div class="font-semibold">Pluto</div>
                <div class="text-xs text-ink-500">Local LLM • CACI</div>
              </div>
            </div>
            <div class="mt-4 text-sm leading-6 text-ink-800">
              I can compile IRAD briefs, summarize Jira/GitLab activity, and answer questions from Postgres (primary) and Mongo (secondary). Responses include citations and deep links.
            </div>
            <div class="mt-4 grid sm:grid-cols-2 gap-2 text-sm">
              <button class="px-3 py-2 rounded-xl border border-ink-200 hover:border-brand-400" hx-get="data:text/html,%3Cli%20class='rounded-xl%20border%20border-brand-200%20bg-brand-50%20px-3%20py-2%20text-brand-800'%3EStarting%20IRAD%20brief%20template%3C/li%3E" hx-target="#suggestions" hx-swap="beforeend">IRAD brief for FCA_V76_1832</button>
              <button class="px-3 py-2 rounded-xl border border-ink-200 hover:border-brand-400" hx-get="data:text/html,%3Cli%20class='rounded-xl%20border%20border-ink-200%20bg-ink-50%20px-3%20py-2'%3EShow%20open%20bugs%20impacting%20SDIT%3C/li%3E" hx-target="#suggestions" hx-swap="beforeend">SDIT open issues</button>
            </div>
            <ul id="suggestions" class="mt-2 text-xs text-ink-600 space-y-2"></ul>
          </div>
        </div>

        <!-- Sample interaction -->
        <div class="max-w-3xl mx-auto">
          <div class="flex gap-3 mb-2">
            <div class="w-9 h-9 rounded-full bg-ink-900 text-white grid place-content-center font-semibold">U</div>
            <div class="max-w-[85%] rounded-2xl rounded-tl-sm bg-ink-100 p-3 text-sm">Summarize critical failures linked to FCA_V76_1832 and draft Jira tickets.</div>
          </div>
          <div class="flex gap-3 justify-end">
            <div class="max-w-[85%] rounded-2xl rounded-tr-sm bg-brand-50 p-3 border border-brand-100 text-sm">
              Found 12 records in <b>testsuite_results</b>. Critical: physics mismatch (SDIT), null telemetry packets (phase 2), CI import failures. Drafted Jira bundle for Unity + Backend.
              <div class="mt-2 text-xs text-ink-600">Citations: Jira PLUTO‑214 • GitLab MR#63 • Postgres rows #1021‑1032</div>
            </div>
            <div class="w-9 h-9 rounded-full bg-brand-600 text-white grid place-content-center font-bold">AI</div>
          </div>
        </div>
      </div>

      <!-- Composer -->
      <div class="border-t border-ink-200 bg-white/80">
        <form id="composer" class="max-w-3xl mx-auto p-3 sm:p-4 flex gap-2 items-end"
              hx-post="data:text/html,%3Cdiv%20class='flex%20gap-3%20justify-end'%3E%3Cdiv%20class='max-w-%5B85%25%5D%20rounded-2xl%20rounded-tr-sm%20bg-brand-50%20p-3%20border%20border-brand-100%20text-sm'%3EStreaming%20mock%20reply%E2%80%94connect%20this%20to%20%2Fpluto%2Fchat%2F%20in%20Django.%3Cdiv%20class='mt-2%20text-xs%20text-ink-600'%3ECitations:%20Postgres%2C%20Jira%2C%20GitLab%3C%2Fdiv%3E%3C%2Fdiv%3E%3Cdiv%20class='w-9%20h-9%20rounded-full%20bg-brand-600%20text-white%20grid%20place-content-center%20font-bold'%3EAI%3C%2Fdiv%3E%3C%2Fdiv%3E"
              hx-target="#messages" hx-swap="beforeend">
          <div class="flex-1 relative">
            <textarea name="q" rows="1" placeholder="Ask Pluto… (Shift+Enter for newline)" class="w-full resize-none rounded-2xl border border-ink-200 px-4 py-3 pr-28 focus:outline-none focus:ring-2 focus:ring-brand-300"></textarea>
            <div class="absolute right-2 bottom-2 flex items-center gap-1">
              <button type="button" class="text-xs px-2 py-1 rounded-lg border border-ink-200 hover:border-brand-400" hx-get="data:text/html,%3Cdiv%20class='text-xs%20px-2%20py-1%20rounded-lg%20bg-ink-900%20text-white'%3E+Postgres%3C%2Fdiv%3E" hx-target="#active-sources" hx-swap="beforeend">+PG</button>
              <button type="button" class="text-xs px-2 py-1 rounded-lg border border-ink-200 hover:border-brand-400" hx-get="data:text/html,%3Cdiv%20class='text-xs%20px-2%20py-1%20rounded-lg%20bg-ink-900%20text-white'%3E+Jira%3C%2Fdiv%3E" hx-target="#active-sources" hx-swap="beforeend">+Jira</button>
              <button type="button" class="text-xs px-2 py-1 rounded-lg border border-ink-200 hover:border-brand-400" hx-get="data:text/html,%3Cdiv%20class='text-xs%20px-2%20py-1%20rounded-lg%20bg-ink-900%20text-white'%3E+GitLab%3C%2Fdiv%3E" hx-target="#active-sources" hx-swap="beforeend">+GL</button>
              <button type="submit" class="ml-1 px-3 py-1.5 rounded-xl bg-brand-600 text-white hover:bg-brand-700">Send</button>
            </div>
          </div>
        </form>
        <div class="max-w-3xl mx-auto px-4 pb-3">
          <div id="active-sources" class="flex flex-wrap gap-2 text-xs text-ink-600"></div>
        </div>
      </div>
    </main>

    <!-- Right Panel: sources & settings -->
    <aside class="hidden lg:flex flex-col border-l border-ink-200 bg-white/70">
      <div class="h-16 px-4 flex items-center justify-between border-b border-ink-100">
        <div class="font-semibold">Citations & Sources</div>
        <button class="text-xs px-2 py-1 rounded-lg border border-ink-200 hover:border-brand-400" hx-get="data:text/html,%3Cli%20class='text-xs'%3EExported%20as%20PDF%20mock.%3C/li%3E" hx-target="#side-log" hx-swap="beforeend">Export PDF</button>
      </div>
      <div class="p-4 space-y-3 text-sm">
        <div class="rounded-xl border border-ink-200 bg-white">
          <div class="px-3 py-2 border-b border-ink-100 font-medium">Last Answer • Citations</div>
          <ul class="p-3 space-y-2">
            <li>Jira: <a class="text-brand-700" href="#">PLUTO‑214</a></li>
            <li>GitLab: <a class="text-brand-700" href="#">MR#63</a>, pipeline #8842</li>
            <li>Postgres: testsuite_results rows #1021‑1032</li>
          </ul>
        </div>
        <div class="rounded-xl border border-ink-200 bg-white">
          <div class="px-3 py-2 border-b border-ink-100 font-medium">Filters</div>
          <div class="p-3 grid grid-cols-2 gap-2">
            <label class="flex items-center justify-between">Postgres<input type="checkbox" checked></label>
            <label class="flex items-center justify-between">Mongo<input type="checkbox"></label>
            <label class="flex items-center justify-between">Jira<input type="checkbox" checked></label>
            <label class="flex items-center justify-between">GitLab<input type="checkbox" checked></label>
            <label class="flex items-center justify-between">Confluence<input type="checkbox"></label>
            <label class="flex items-center justify-between">Email<input type="checkbox"></label>
          </div>
        </div>
        <div class="rounded-xl border border-ink-200 bg-white">
          <div class="px-3 py-2 border-b border-ink-100 font-medium">Audit Log</div>
          <ul id="side-log" class="p-3 space-y-2 text-xs text-ink-600">
            <li>RBAC: Engineer • Citations enabled</li>
          </ul>
        </div>
      </div>
    </aside>
  </div>

  <!-- Settings Drawer (Prompt Profile) -->
  <div id="drawer" class="fixed inset-0 hidden" _="on click from #openSettings toggle .hidden on #drawer">
    <div class="absolute inset-0 bg-black/30" _="on click toggle .hidden on #drawer"></div>
    <div class="absolute right-0 top-0 h-full w-full max-w-lg bg-white shadow-xl2 p-5 overflow-y-auto">
      <div class="flex items-center justify-between">
        <h3 class="text-lg font-semibold">Prompt Profile</h3>
        <button class="px-2 py-1 rounded-lg border border-ink-200" _="on click toggle .hidden on #drawer">✕</button>
      </div>
      <form class="mt-4 space-y-3"
            hx-post="data:text/html,%3Cdiv%20class='rounded-xl%20border%20border-brand-200%20bg-brand-50%20p-3%20text-brand-800'%3ESettings%20saved.%3C/div%3E"
            hx-target="#settings-result" hx-swap="innerHTML">
        <div>
          <label class="block text-sm font-medium">System Prompt</label>
          <textarea rows="6" class="mt-1 w-full rounded-xl border border-ink-200 px-3 py-2">You are Pluto, a CACI internal assistant. Cite sources with record IDs. Enforce RBAC. Avoid external PII. Prefer concise, decision‑ready answers.</textarea>
        </div>
        <div class="grid sm:grid-cols-2 gap-3 text-sm">
          <label class="flex items-center justify-between">Require citations<input type="checkbox" checked></label>
          <label class="flex items-center justify-between">Safe‑reply mode<input type="checkbox"></label>
          <label class="flex items-center justify-between">CC ops channel<input type="checkbox"></label>
          <label class="flex items-center justify-between">Mask PII<input type="checkbox" checked></label>
        </div>
        <div>
          <label class="block text-sm font-medium">Redaction Rules</label>
          <textarea rows="4" class="mt-1 w-full rounded-xl border border-ink-200 px-3 py-2">Mask emails, phone numbers, contractor identifiers. Return only UNCLASS/CUI visible to the requester. Strip secrets/tokens.</textarea>
        </div>
        <div class="flex items-center justify-end gap-2">
          <button type="button" class="px-3 py-2 rounded-xl border border-ink-200" _="on click toggle .hidden on #drawer">Cancel</button>
          <button type="submit" class="px-4 py-2 rounded-xl bg-brand-600 text-white hover:bg-brand-700">Save</button>
        </div>
      </form>
      <div id="settings-result" class="mt-3 text-sm"></div>
    </div>
  </div>

  <script>
    // Autosize textarea (simple)
    const composer = document.querySelector('#composer textarea');
    composer && composer.addEventListener('input', () => {
      composer.style.height = 'auto';
      composer.style.height = composer.scrollHeight + 'px';
    });
  </script>
</body>
</html>
